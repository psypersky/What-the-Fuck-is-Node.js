<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <h1>Sign in</h1>
  <form action="/signin" method="POST"  onsubmit="return validate();">
    <input type="email" name="email" placeholder="E-mail"/>
    <br>
    <br>
    <input type="text" name="user" placeholder="User"/>
    <br>
    <br>
    <input type="password" name="pass" placeholder="Password">
    <br>
    <br>
    <input type="tel" name="tel" placeholder="Telephone">
    <br>
    <br>
    <input type="submit" value="Submit">
  </form>

  <script>
  function validate()
   {
    var email = document.getElementsByName("email"),
      user = document.getElementsByName("user"),
      pass = document.getElementsByName("pass"),
      tel = document.getElementsByName("tel"),
      info;

    info = "email=" + email[0].value + "&user=" + user[0].value + "&password=" + pass[0].value + "&telephone=" + tel[0].value;
    console.log(info);
    var promise = new Promise(function(resolve, reject){
      let request = new XMLHttpRequest();
      request.open('POST', "/signin");
      request.onload = function() {
        if (request.status === 200) {
          resolve(request.response);
        }
        else {
          reject(request.response);
          throw 'Lo intentamos pero no pudo funcionar.';
        }
      };
      request.send(info);
  });
  promise.then(function(info){
  location.reload();

}, function(info){
      // data = data.split(',');
      // if (data[0] === "true") {
      //     document.getElementById('errEmail').innerHTML = " llena el capo de email puñetas";
      // }
      // if (data[1] === "true") {
      //     document.getElementById('errUser').innerHTML = " llena el capo de user puñetas";
      // }
      // if (data[2] === "true") {
      //     document.getElementById('errPass').innerHTML = " llena el capo de password puñetas";
      // }
      // if (data[2] === "less") {
      //     document.getElementById('errPass').innerHTML = " minimo 6 caracteres basura";
      // }
  });
  return false;
}
</script>
</body>
</html>
